(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["110d8b8d"],{"32af":function(t,e,s){"use strict";var a=s("43aa"),i=s.n(a);i.a},"43aa":function(t,e,s){},c43a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"flex justify-center items-center"},[s("q-ajax-bar",{ref:"bar",attrs:{position:"bottom",color:"accent",size:"10px","skip-hijack":""}}),s("div",{staticClass:"flex column items-center"},[s("q-btn",{staticClass:"btn-search",attrs:{round:"",color:t.searchBtnColor,"text-color":t.searchBtnTextColor,label:t.searchBtnText},on:{click:t.onSearchBtnClick}},[s("small",{staticClass:"text-weight-bolder",class:t.isSearching?"search-cancel-text":"hidden"},[t._v("\n        "+t._s(t.$t("cancel"))+"\n      ")]),s("q-spinner-dots",{ref:"search-loading",class:t.isSearching?"search-spinner":"hidden",attrs:{color:"dark-purple",size:"1em"}})],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("q-card",{staticClass:"bg-deep-purple-1"},[s("q-bar",{staticClass:"bg-dark-purple"},[s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close","text-color":"white"}},[s("q-tooltip",{attrs:{"content-class":"bg-dark-purple text-white"}},[t._v("Close")])],1)],1),s("q-card-section",[s("div",{staticClass:"text-h6 text-center text-primary"},[t._v(t._s(t.$t("usersFound")))])]),t.foundUsers&&0!==t.foundUsers.length?t._e():s("q-card-section",{staticClass:"users-section q-gutter-y-md bg-white"},[s("div",{staticClass:"text-h5 text-center text-primary"},[s("q-icon",{attrs:{name:"mdi-package-variant"}}),t._v("\n          "+t._s(t.$t("noUserFound"))+"\n        ")],1)]),s("q-card-section",{staticClass:"users-section q-gutter-y-md bg-white"},t._l(t.foundUsers,function(e){return s("div",{key:e.id,staticClass:"found-user bg-grey-1 q-my-lg"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-1 col-2"},[s("q-avatar",{attrs:{size:"60px"}},[s("q-img",{ref:"avatarImg",refInFor:!0,staticClass:"fit",attrs:{src:t.avatarUrl+e.id,"spinner-color":"accent"},scopedSlots:t._u([{key:"error",fn:function(){return[s("div",{staticClass:"absolute-full text-white",staticStyle:{padding:"0"}},[s("q-icon",{staticStyle:{"font-size":"60px"},attrs:{name:"account_circle"}})],1)]},proxy:!0}],null,!0)})],1)],1),s("div",{staticClass:"q-pl-lg col-6 row"},[s("span",{staticClass:"text-bold col-12"},[t._v(t._s(e.name+" "+e.lastName))]),s("span",{staticClass:"col-12"},[t._v("\n                "+t._s(t.$t("distanceOf",{distance:t.$toDistance(e.distance)}))+"\n              ")])]),s("div",{staticClass:"send-request-btn offset-sm-2 col-sm-3 col-12 q-pt-xs-sm q-pt-sm-none"},[s("q-btn",{ref:"button"+e.id,refInFor:!0,staticClass:"full-width",attrs:{outline:"",color:"positive",label:t.$t("sendRequest")},on:{click:function(s){return t.sendFriendRequest(e)}}},[s("q-icon",{ref:"buttonIcon"+e.id,refInFor:!0,staticClass:"hidden",attrs:{name:"mdi-check-circle-outline"}})],1)],1)])])}),0)],1)],1)],1)},i=[],r={name:"PageIndex",data:function(){return{maxZoom:15,minZoom:10,user:{id:this.$store.getters["auth/getAccount"].id,username:this.$store.getters["auth/getAccount"].username},isUpdated:!1,userList:null,isSearching:!1,searchBtnColor:"dark-purple",searchBtnTextColor:"white",searchBtnText:this.$t("search"),dialog:!1,avatarUrl:"".concat("https://intouristing-api.herokuapp.com/","users/avatar/"),foundUsers:[]}},methods:{$_updateBtnStyle:function(){this.searchBtnColor=this.isSearching?"white":"dark-purple",this.searchBtnTextColor=this.isSearching?"dark-purple":"white",this.searchBtnText=this.$t(this.isSearching?"searching":"search")},onSearchBtnClick:function(){this.isSearching?this.$_onCancel():this.$_onSearch()},$_onCancel:function(){this.$q.loading.show();try{this.$store.dispatch("stomp/cancelSearch"),this.isSearching=!1,this.$_updateBtnStyle()}finally{this.$q.loading.hide()}},$_onSearch:function(){var t=this;"geolocation"in navigator?(this.$q.loading.show(),navigator.geolocation.getCurrentPosition(function(){t.$q.loading.hide();var e=500,s=t.$getStompHeaders();s.id="".concat(t.user.username,"-search"),t.isSearching=!0,t.$_updateBtnStyle(),t.$store.dispatch("stomp/subscribe",{name:"search",destination:"/user/queue/search",callback:function(a,i){var r=JSON.parse(a.body),n=i.getters.getSearch.counter;i.dispatch("insertResult",r.users),n>2&&i.dispatch("finishSearch"),i.getters.getSearch.cancelled||i.getters.getSearch.finished?i.getters.getSearch.finished?(t.isSearching=!1,t.$_updateBtnStyle(),t.foundUsers=i.getters.getSearch.result,t.dialog=!0):i.getters.getSearch.cancelled&&t.$warningAlert(t.$t("searchCancelled")):setTimeout(function(){i.dispatch("incrementSearchCounter"),i.dispatch("send",{destination:"/ws/search",body:.5*i.getters.getSearch.counter,headers:s})},e)},headers:s,afterSubscription:function(t){t.dispatch("startSearch")}}),t.$store.dispatch("stomp/send",{destination:"/ws/search",body:.175*t.$store.getters["stomp/getSearch"].counter,headers:s})},function(e){console.error(e),e.code===e.PERMISSION_DENIED&&t.$errorAlert(t.$t("permissionGeolocationRequired"))},{enableHighAccuracy:!1,maximumAge:1/0})):this.$errorAlert(this.$t("browserNotSupported"))},sendFriendRequest:function(t){var e=this.$refs["button".concat(t.id)][0].$el,s=this.$refs["buttonIcon".concat(t.id)][0].$el;if(!e.classList.contains("disabled")){var a=this.$getStompHeaders();a.id="".concat(this.user.username,"-request"),this.$store.dispatch("stomp/send",{destination:"/ws/request",body:{destination:{id:t.id}},headers:a}),this.$successAlert(this.$t("requestSent")),e.classList.add("disabled"),s.classList.remove("hidden")}}}},n=r,c=(s("32af"),s("2877")),o=Object(c["a"])(n,a,i,!1,null,"0f86ee97",null);e["default"]=o.exports}}]);